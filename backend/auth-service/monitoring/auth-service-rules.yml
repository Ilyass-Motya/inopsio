# Auth Service Prometheus Alert Rules
groups:
  - name: auth-service-alerts
    rules:
      - alert: AuthServiceDown
        expr: up{job="auth-service"} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "Auth Service is down"
          description: "Auth Service has been down for more than 1 minute"

      - alert: HighAuthenticationFailureRate
        expr: rate(auth_failed_attempts_total[5m]) > 10
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "High authentication failure rate"
          description: "Authentication failure rate is {{ $value }} failures per second"

      - alert: HighTokenValidationLatency
        expr: auth_token_validation_duration_seconds{quantile="0.95"} > 2
        for: 2m
        labels:
          severity: warning
        annotations:
          summary: "High token validation latency"
          description: "95th percentile token validation latency is {{ $value }}s"

      - alert: SuspiciousLoginActivity
        expr: rate(auth_suspicious_attempts_total[10m]) > 5
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: "Suspicious login activity detected"
          description: "Suspicious login attempts rate is {{ $value }} per second"
